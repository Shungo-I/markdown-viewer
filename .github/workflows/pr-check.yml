name: PR Check

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  pr-size-check:
    name: PR Size Check
    runs-on: ubuntu-latest
    
    steps:
      - name: ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: PR ã‚µã‚¤ã‚ºã‚’ãƒã‚§ãƒƒã‚¯
        uses: actions/github-script@v7
        with:
          script: |
            const { data: pr } = await github.rest.pulls.get({
              owner: context.repo.owner,
              repo: context.repo.repo,
              pull_number: context.issue.number,
            });
            
            const changedFiles = pr.changed_files;
            const additions = pr.additions;
            const deletions = pr.deletions;
            
            console.log(`å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«æ•°: ${changedFiles}`);
            console.log(`è¿½åŠ è¡Œæ•°: ${additions}`);
            console.log(`å‰Šé™¤è¡Œæ•°: ${deletions}`);
            
            let message = `## ğŸ“Š PR ã‚µã‚¤ã‚ºãƒ¬ãƒãƒ¼ãƒˆ\n\n`;
            message += `- å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«æ•°: **${changedFiles}**\n`;
            message += `- è¿½åŠ è¡Œæ•°: **${additions}**\n`;
            message += `- å‰Šé™¤è¡Œæ•°: **${deletions}**\n\n`;
            
            if (changedFiles > 20 || additions > 500) {
              message += `âš ï¸ **å¤§ããªPRã§ã™**: ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å®¹æ˜“ã«ã™ã‚‹ãŸã‚ã€ã‚ˆã‚Šå°ã•ãªPRã«åˆ†å‰²ã™ã‚‹ã“ã¨ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚\n`;
              core.setFailed('PR size is too large');
            } else if (changedFiles > 10 || additions > 200) {
              message += `ğŸ”¶ **ä¸­ç¨‹åº¦ã®PRã§ã™**: å•é¡Œã‚ã‚Šã¾ã›ã‚“ãŒã€ã§ãã‚Œã°å°ã•ã‚ã«ä¿ã¤ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚\n`;
            } else {
              message += `âœ… **é©åˆ‡ãªã‚µã‚¤ã‚ºã®PRã§ã™**: ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã‚„ã™ã„ã‚µã‚¤ã‚ºã§ã™ï¼\n`;
            }
            
            // PRã«ã‚³ãƒ¡ãƒ³ãƒˆ
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.issue.number,
              body: message
            }); 